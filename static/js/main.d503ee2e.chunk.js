(this["webpackJsonpjoins-meet"]=this["webpackJsonpjoins-meet"]||[]).push([[0],{247:function(e,t,n){},260:function(e,t,n){},263:function(e,t,n){},373:function(e,t,n){},407:function(e,t,n){},420:function(e,t,n){},425:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),i=n(60),o=n.n(i),r=(n(247),n(10)),s=n(98),u=n(99),l=n(230),j=n(229),d=n(51),b=n(205),h=(n(260),n(4)),O=function(e){Object(l.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(s.a)(this,n);for(var c=arguments.length,a=new Array(c),i=0;i<c;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={isSignedIn:!1},e.uiConfig={signInFlow:"popup",signInOptions:[d.a.auth.GoogleAuthProvider.PROVIDER_ID,d.a.auth.FacebookAuthProvider.PROVIDER_ID,d.a.auth.GithubAuthProvider.PROVIDER_ID],callbacks:{signInSuccess:function(){return!1}}},e.componentDidMount=function(){d.a.auth().onAuthStateChanged((function(t){e.setState({isSignedIn:!!t})}))},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(h.jsx)("div",{className:"continueWith",children:this.state.isSignedIn?Object(h.jsx)("span",{}):Object(h.jsxs)("div",{className:"continueWith__content",children:[Object(h.jsx)("p",{className:"continueWith__title",children:"Sign in"}),Object(h.jsx)("p",{className:"continueWith__subtitle",children:"Continue to Joins"}),Object(h.jsx)(b.StyledFirebaseAuth,{uiConfig:this.uiConfig,firebaseAuth:d.a.auth()})]})})}}]),n}(c.Component),f=O,m=n(126),p=n.n(m),x=n(207),g=n(61),v=(n(474),n(484)),y=n(478),k=n(482),N=n(475),S=n(477),w=n(479),C=n(228),E=n(486),A=n(481);n(140);d.a.initializeApp({apiKey:"AIzaSyAswSs5I_Ow2zqhEKy1cfpZTLS8sy7PYsA",authDomain:"meeting-3ecfa.firebaseapp.com",projectId:"meeting-3ecfa",storageBucket:"meeting-3ecfa.appspot.com",messagingSenderId:"940410080677",appId:"1:940410080677:web:dad8c866e2b666c92c6c4c",measurementId:"G-7QHJGCKWLK"});var _=d.a.auth(),I=n(26),P=(n(263),n(122)),D=n.n(P),M=n(19),L=(n(373),n(487)),U=function(e){var t=e.participant,n=e.totalParticipant,a=e.currentUser,i=Object(c.useState)([]),o=Object(r.a)(i,2),s=o[0],u=o[1],l=Object(c.useState)([]),j=Object(r.a)(l,2),d=j[0],b=j[1],O=Object(c.useRef)(),f=Object(c.useRef)(),m=function(e){return Array.from(e.values()).map((function(e){return e.track})).filter((function(e){return null!==e}))};return Object(c.useEffect)((function(){u(m(t.videoTracks)),b(m(t.audioTracks));return t.on("trackSubscribed",(function(e){"video"===e.kind?u((function(t){return[].concat(Object(M.a)(t),[e])})):"audio"===e.kind&&b((function(t){return[].concat(Object(M.a)(t),[e])}))})),t.on("trackUnsubscribed",(function(e){"video"===e.kind?u((function(t){return t.filter((function(t){return t!==e}))})):"audio"===e.kind&&b((function(t){return t.filter((function(t){return t!==e}))}))})),function(){u([]),b([]),t.removeAllListeners()}}),[t]),Object(c.useEffect)((function(){var e=s[0];if(e)return e.attach(O.current),function(){e.detach()}}),[s]),Object(c.useEffect)((function(){var e=d[0];if(e)return e.attach(f.current),function(){e.detach()}}),[d]),Object(h.jsxs)("div",{className:"participant ".concat(0===(null===n||void 0===n?void 0:n.length)&&"one_participant"),children:[Object(h.jsx)("p",{className:"participant-name",children:Object(h.jsx)(L.a,{sx:{backgroundColor:"rgba(0,0,0,.4)",p:.4},children:t.identity===a?"You":t.identity})}),Object(h.jsx)("video",{ref:O,autoPlay:!0}),Object(h.jsx)("audio",{ref:f,autoPlay:!0})]})},R=n(210),T=n(211),V=n.n(T),B="new-message-event",G=function(e){var t=Object(c.useState)([]),n=Object(r.a)(t,2),a=n[0],i=n[1],o=Object(c.useRef)();Object(c.useEffect)((function(){return o.current=V()("https://trishul-meeting-server.herokuapp.com/",{query:{roomId:e}}),o.current.on(B,(function(e){var t=Object(g.a)(Object(g.a)({},e),{},{isOwner:e.senderId===o.current.id});i((function(e){return[].concat(Object(M.a)(e),[t])}))})),function(){o.current.disconnect()}}),[e]);return{messages:a,sendMessage:function(e,t){t?o.current.emit(B,{body:t,type:"file",mimeType:t.type,fileName:t.name,senderId:o.current.id}):o.current.emit(B,{body:e,senderId:o.current.id})}}},J=(n(407),n(215)),F=n.n(J),z=n(472),K=n(488),W=n(214),q=n.n(W);var Y=function(e){var t=Object(c.useState)(""),n=Object(r.a)(t,2),a=n[0],i=n[1];return Object(c.useEffect)((function(){var t=new FileReader;t.readAsDataURL(e.blob),t.onloadend=function(){i(t.result)}}),[e.blob]),Object(h.jsx)("img",{className:"image",style:{width:150,height:"auto"},src:a,alt:e.fileName})},H=n(212),Q=n.n(H),Z=n(213),X=n.n(Z),$=function(e){var t=e.roomId,n=G(t),a=n.messages,i=n.sendMessage,o=Object(c.useState)(""),s=Object(r.a)(o,2),u=s[0],l=s[1],j=Object(c.useState)(),d=Object(r.a)(j,2),b=d[0],O=d[1],f=Object(c.useState)(null),m=Object(r.a)(f,2),p=(m[0],m[1]),x=Object(c.useState)("notDisplayEmoji"),g=Object(r.a)(x,2),v=g[0],y=g[1],k=Object(c.useRef)(),N=function(){""!==u&&(i(u,b),l(""),O(),y("notDisplayEmoji"))};return Object(c.useEffect)((function(){return k.current.scrollIntoView({behavior:"smooth"})})),Object(h.jsx)("div",{className:"chatbox",children:Object(h.jsxs)("div",{className:"chatRoomMain",children:[Object(h.jsxs)("div",{className:"group_chat_bar",children:[Object(h.jsx)("span",{className:"group_chat_title",children:"Group Chat"}),Object(h.jsx)("span",{className:"group_chat_msg_btn",children:"Messages"}),Object(h.jsx)("span",{className:"group_chat_partici",children:"Participants"})]}),Object(h.jsxs)("div",{className:"chat-container",children:[Object(h.jsxs)("div",{className:"msg",children:[Object(h.jsx)("ol",{id:"messages",children:a.map((function(e,t){if("file"===e.type){var n=new Blob([e.body],{type:e.type});return Object(h.jsx)("div",{className:e.isOwner?"my-message":"received-message",children:Object(h.jsx)("div",{className:"msgBody",children:Object(h.jsx)(Y,{fileName:e.fileName,blob:n})})},t)}return Object(h.jsx)("div",{className:e.isOwner?"my-message":"received-message",children:Object(h.jsx)("div",{className:"msgBody",children:Object(h.jsx)(X.a,{componentDecorator:function(e,t){return Object(h.jsx)(R.SecureLink,{href:e,children:t})},children:e.body})})},t)}))}),Object(h.jsx)("div",{ref:k})]}),Object(h.jsx)("div",{className:v,children:Object(h.jsx)(Q.a,{onEmojiClick:function(e,t){l(u+t.emoji),p(t)}})})]}),Object(h.jsxs)("div",{id:"form",className:"textField",children:[Object(h.jsxs)("label",{htmlFor:"raised-button-file",children:[Object(h.jsx)("input",{accept:"image/*",onChange:function(e){l(e.target.files[0].name),O(e.target.files[0])},style:{display:"none"},id:"raised-button-file",multiple:!0,type:"file"}),Object(h.jsx)(K.a,{className:"camera","aria-label":"upload picture",component:"span",children:Object(h.jsx)(z.a,{})})]}),Object(h.jsx)("label",{children:Object(h.jsx)(K.a,{"aria-label":"emoji",component:"span",onClick:function(){"notDisplayEmoji"===v?y("displayEmoji"):"displayEmoji"===v&&y("notDisplayEmoji")},children:Object(h.jsx)(q.a,{})})}),Object(h.jsx)("input",{id:"message",placeholder:"Enter message here",value:u,onChange:function(e){l(e.target.value)},onKeyUp:function(e){"Enter"===e.key&&N()}}),Object(h.jsx)("button",{onClick:N,children:Object(h.jsx)(F.a,{})})]})]})})},ee=(n(420),n(216)),te=n.n(ee),ne=n(217),ce=n.n(ne),ae=n(218),ie=n.n(ae),oe=n(219),re=n.n(oe),se=n(220),ue=n.n(se),le=n(221),je=n.n(le),de=n(222),be=n.n(de),he=n(223),Oe=n.n(he),fe=n(224),me=n.n(fe),pe=n(225),xe=n.n(pe),ge=n(226),ve=n.n(ge);function ye(e){var t=e.handleLogout,n=e.handleAudioMute,a=e.handleAudioUnmute,i=e.handleVideoMute,o=e.handleVideoUnmute,s=(e.roomName,Object(c.useState)(!0)),u=Object(r.a)(s,2),l=u[0],j=u[1],d=Object(c.useState)(!0),b=Object(r.a)(d,2),O=b[0],f=b[1],m=Object(c.useState)(!0),p=Object(r.a)(m,2),x=p[0],g=p[1];return Object(h.jsx)(L.a,{children:Object(h.jsxs)(L.a,{component:"span",sx:{backgroundColor:"#141414",m:"auto",p:2,borderRadius:3,boxShadow:24},display:"flex",width:500,alignItems:"center",justifyContent:"center",children:[Object(h.jsx)(v.a,{onClick:function(){!1===l?(j(!0),a()):!0===l&&(j(!1),n())},sx:{color:"white"},children:!0===l?Object(h.jsx)(te.a,{sx:{color:"#00a389"}}):Object(h.jsx)(ce.a,{sx:{color:"white"}})}),Object(h.jsx)(v.a,{onClick:function(){!1===O?(f(!0),o()):!0===O&&(f(!1),i())},sx:{color:"white"},children:!0===O?Object(h.jsx)(ie.a,{sx:{color:"#00a389"}}):Object(h.jsx)(re.a,{sx:{color:"white"}})}),Object(h.jsx)(v.a,{onClick:function(){!1===x?g(!0):!0===x&&g(!1)},sx:{color:"white"},children:!0===x?Object(h.jsx)(ue.a,{sx:{color:"#00a389"}}):Object(h.jsx)(je.a,{sx:{color:"white"}})}),Object(h.jsx)(v.a,{sx:{color:"white"},children:Object(h.jsx)(be.a,{})}),Object(h.jsx)(v.a,{sx:{color:"white"},children:Object(h.jsx)(Oe.a,{})}),Object(h.jsx)(v.a,{sx:{color:"white"},children:Object(h.jsx)(me.a,{})}),Object(h.jsx)(v.a,{sx:{color:"white"},children:Object(h.jsx)(xe.a,{})}),Object(h.jsx)(v.a,{onClick:t,sx:{backgroundColor:"#fc0303",":hover":{backgroundColor:"#fa3939"},color:"white"},children:Object(h.jsx)(ve.a,{})})]})})}var ke=n(6),Ne=n(489),Se=n(485),we=function(e){var t=e.roomName,n=e.room,a=e.handleLogout,i=e.currentUser,o=e.handleAudioMute,s=e.handleAudioUnmute,u=e.handleVideoMute,l=e.handleVideoUnmute,j=Object(c.useState)([]),d=Object(r.a)(j,2),b=d[0],O=d[1],f=Object(c.useState)("displayChat"),m=Object(r.a)(f,2);m[0],m[1];Object(c.useEffect)((function(){var e=function(e){O((function(t){return[].concat(Object(M.a)(t),[e])}))},t=function(e){O((function(t){return t.filter((function(t){return t!==e}))}))};return n.on("participantConnected",e),n.on("participantDisconnected",t),n.participants.forEach(e),function(){n.off("participantConnected",e),n.off("participantDisconnected",t)}}),[n]);var p=b.map((function(e){return Object(h.jsx)(U,{participant:e,currentUser:i},e.sid)}));Object(ke.a)(Ne.a)((function(e){var t=e.theme;return Object(g.a)(Object(g.a)({},t.typography.body2),{},{padding:t.spacing(2),textAlign:"center",color:t.palette.text.secondary})}));return Object(h.jsx)("main",{className:"room",children:Object(h.jsx)(L.a,{sx:{flexGrow:1},children:Object(h.jsxs)(Se.a,{container:!0,spacing:2,children:[Object(h.jsxs)(Se.a,{item:!0,xs:8,children:[Object(h.jsxs)(Se.a,{container:!0,spacing:2,children:[Object(h.jsx)(Se.a,{item:!0,xs:4,children:Object(h.jsx)(L.a,{sx:{boxShadow:24},children:n?Object(h.jsx)(U,{totalParticipant:b,participant:n.localParticipant},n.localParticipant.sid):""})},"1"),Object(h.jsx)(Se.a,{item:!0,xs:4,children:Object(h.jsx)(L.a,{sx:{boxShadow:24},children:p})},"2")]}),Object(h.jsx)(L.a,{sx:{mt:4},children:Object(h.jsx)(ye,{handleLogout:a,handleAudioMute:o,handleAudioUnmute:s,handleVideoMute:u,handleVideoUnmute:l,roomName:t})})]}),Object(h.jsx)(Se.a,{item:!0,xs:4,children:Object(h.jsx)(L.a,{sx:{backgroundColor:"white"},children:Object(h.jsx)($,{roomId:t})})})]})})})},Ce=(n(122).createLocalVideoTrack,Object(C.a)()),Ee=Object(w.a)((function(){return{large:{width:Ce.spacing(7),height:Ce.spacing(7)}}}));var Ae=function(){var e=Object(c.useState)(null),t=Object(r.a)(e,2),n=t[0],i=t[1],o=Object(c.useState)("empty"),s=Object(r.a)(o,2),u=(s[0],s[1]),l=Object(c.useState)(null),j=Object(r.a)(l,2),d=j[0],b=(j[1],Object(c.useState)(new Date)),O=Object(r.a)(b,2),f=(O[0],O[1]),m=Object(c.useState)(""),g=Object(r.a)(m,2),w=g[0],C=g[1],P=Object(c.useState)(null),M=Object(r.a)(P,2),L=M[0],U=M[1],R=Object(c.useState)(""),T=Object(r.a)(R,2),V=T[0],B=T[1];Ee(),Object(I.f)(),Boolean(d),null!==(null===n||void 0===n?void 0:n.displayName)&&(null===n||void 0===n||n.displayName.charAt(0).toUpperCase()),Object(c.useEffect)((function(){return _.onAuthStateChanged((function(e){e?(i(e),u("home"),console.log(e.isAnonymous)):(i(null),u("login"))})),setInterval((function(){return f(new Date)}),1e3)}),[]),Object(c.useEffect)((function(){n&&B(n.displayName)}),[n]);var G=a.a.useState(!1),J=Object(r.a)(G,2),F=J[0],z=J[1],K=function(){z(!1)},W=Object(c.useCallback)(Object(x.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://twilio-meeting-server.herokuapp.com/video/token",{method:"POST",body:JSON.stringify({identity:V,room:w}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}));case 2:t=e.sent,D.a.connect(t.token,{name:w}).then((function(e){U(e)})).catch((function(e){console.error(e)})),console.log(t);case 5:case"end":return e.stop()}}),e)}))),[w,V]),q=Object(c.useCallback)((function(){K(),U((function(e){return e&&(e.localParticipant.tracks.forEach((function(e){e.track.stop()})),e.disconnect()),null}))}),[]);return Object(c.useEffect)((function(){if(L){var e=function(e){e.persisted||L&&q()};return window.addEventListener("pagehide",e),window.addEventListener("beforeunload",e),function(){window.removeEventListener("pagehide",e),window.removeEventListener("beforeunload",e)}}}),[L,q]),L?Object(h.jsx)(we,{roomName:w,room:L,handleLogout:q,currentUser:n,handleAudioMute:function(){L.localParticipant.audioTracks.forEach((function(e){return e.track.disable()}))},handleAudioUnmute:function(){L.localParticipant.audioTracks.forEach((function(e){return e.track.enable()}))},handleVideoMute:function(){L.localParticipant.videoTracks.forEach((function(e){return e.track.disable()}))},handleVideoUnmute:function(){L.localParticipant.videoTracks.forEach((function(e){return e.track.enable()}))}}):Object(h.jsx)("div",{children:Object(h.jsx)("div",{className:"home",children:Object(h.jsxs)("div",{className:"home__left",children:[Object(h.jsxs)("div",{className:"home__buttons",children:[Object(h.jsxs)(v.a,{sx:{backgroundColor:"#00a389","&:hover":{backgroundColor:"#18c2a7"}},variant:"contained",className:"home__createBTN",onClick:function(){var e=Date.now();console.log(e),e=(e=Math.floor(Math.random()*Math.floor(Math.random()*e.toString().slice(-9)))).toString().substring(0,3)+"-"+e.toString().substring(3,6)+"-"+e.toString().substring(6,e.toString().length),console.log(e),C(e)},children:[Object(h.jsx)(N.a,{}),Object(h.jsx)("p",{children:"New meeting"})]}),Object(h.jsx)(y.a,{className:"home__input",variant:"outlined",value:w,onChange:function(e){return C(e.target.value)},placeholder:"Enter a code or link",InputProps:{startAdornment:Object(h.jsx)(k.a,{position:"start",children:Object(h.jsx)(S.a,{className:"icon"})})}}),Object(h.jsx)(v.a,{color:"primary",variant:"outlined",className:"home__joinBTN",disabled:""===w,onClick:function(){z(!F),""!==w&&(console.log(n.displayName),n.isAnonymous&&""===n.displayName?(n.updateProfile({displayName:"Abhinav"}).then((function(){var e=n.displayName;console.log("Display Name: ".concat(e))}),(function(e){console.log("Guest Login Error: ".concat(e))})),W()):W())},children:"Join"}),Object(h.jsx)(v.a,{onClick:function(){n.isAnonymous&&n.delete(),_.signOut()},variant:"outlined",className:"home__signOut",children:"Sign Out"})]}),Object(h.jsx)("div",{children:Object(h.jsx)(A.a,{sx:{color:"#fff",zIndex:function(e){return e.zIndex.drawer+1}},open:F,onClick:K,children:Object(h.jsx)(E.a,{color:"inherit"})})})]})})})},_e=n(124);var Ie=function(){var e=Object(c.useState)(null),t=Object(r.a)(e,2),n=(t[0],t[1]),a=Object(c.useState)("empty"),i=Object(r.a)(a,2),o=i[0],s=i[1];return Object(c.useEffect)((function(){_.onAuthStateChanged((function(e){e?(n(e),s("home")):(n(null),s("login"))}))}),[]),Object(h.jsx)("div",{className:"App",children:Object(h.jsx)(_e.a,{children:Object(h.jsx)(I.c,{children:Object(h.jsx)(I.a,{path:"/Joins-Meeting-App",exact:!0,children:Object(h.jsxs)("div",{children:["empty"===o&&Object(h.jsx)("p",{children:"Loading...."}),"home"===o&&Object(h.jsx)(Ae,{}),"login"===o&&Object(h.jsx)(f,{})]})})})})})};o.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(Ie,{})}),document.getElementById("root"))}},[[425,1,2]]]);
//# sourceMappingURL=main.d503ee2e.chunk.js.map