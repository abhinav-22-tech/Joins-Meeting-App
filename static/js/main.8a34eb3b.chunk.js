(this["webpackJsonpjoins-meet"]=this["webpackJsonpjoins-meet"]||[]).push([[0],{237:function(e,t,n){},250:function(e,t,n){},257:function(e,t,n){},367:function(e,t,n){},397:function(e,t,n){},410:function(e,t,n){},415:function(e,t,n){},416:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),i=n(56),s=n.n(i),r=(n(237),n(10)),o=n(93),u=n(94),l=n(219),j=n(218),d=n(48),b=n(194),f=(n(250),n(196)),O=n.n(f),h=n(3),m=function(e){Object(l.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(o.a)(this,n);for(var c=arguments.length,a=new Array(c),i=0;i<c;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={isSignedIn:!1},e.uiConfig={signInFlow:"popup",signInOptions:[d.a.auth.GoogleAuthProvider.PROVIDER_ID,d.a.auth.FacebookAuthProvider.PROVIDER_ID,d.a.auth.GithubAuthProvider.PROVIDER_ID],callbacks:{signInSuccess:function(){return!1}}},e.componentDidMount=function(){d.a.auth().onAuthStateChanged((function(t){e.setState({isSignedIn:!!t})}))},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(h.jsx)("div",{className:"continueWith",children:this.state.isSignedIn?Object(h.jsx)("span",{}):Object(h.jsxs)("div",{className:"continueWith__content",children:[Object(h.jsx)("p",{className:"continueWith__title",children:"Sign in"}),Object(h.jsx)("p",{className:"continueWith__subtitle",children:"Continue to Joins"}),Object(h.jsx)(b.StyledFirebaseAuth,{uiConfig:this.uiConfig,firebaseAuth:d.a.auth()}),Object(h.jsx)("div",{className:"continueWith__try_text",children:"Try demo"}),Object(h.jsxs)("button",{className:"firebaseui-idp-button mdl-button mdl-js-button mdl-button--raised firebaseui-id-idp-button",style:{backgroundColor:"red"},"data-upgraded":",MaterialButton",onClick:function(){d.a.auth().signInAnonymously().then((function(){})).catch((function(e){e.code,e.message}))},children:[Object(h.jsx)("span",{class:"firebaseui-idp-icon-wrapper",children:Object(h.jsx)(O.a,{style:{color:"white",verticalAlign:"middle"}})}),Object(h.jsx)("span",{class:"firebaseui-idp-text firebaseui-idp-text-long",children:"Sign in As Guest"}),Object(h.jsx)("span",{class:"firebaseui-idp-text firebaseui-idp-text-short",children:"GitHub"})]})]})})}}]),n}(c.Component),p=m,g=n(118),v=n.n(g),x=n(199),y=n(469),N=n(464),S=n(467),k=n(461),_=n(463),E=n(465),w=n(217);n(129);d.a.initializeApp({apiKey:"AIzaSyAswSs5I_Ow2zqhEKy1cfpZTLS8sy7PYsA",authDomain:"meeting-3ecfa.firebaseapp.com",projectId:"meeting-3ecfa",storageBucket:"meeting-3ecfa.appspot.com",messagingSenderId:"940410080677",appId:"1:940410080677:web:dad8c866e2b666c92c6c4c",measurementId:"G-7QHJGCKWLK"});var I=d.a.auth(),C=n(26),A=(n(257),n(200)),D=n.n(A),P=n(22),R=(n(367),function(e){var t=e.participant,n=e.totalParticipant,a=e.currentUser,i=Object(c.useState)([]),s=Object(r.a)(i,2),o=s[0],u=s[1],l=Object(c.useState)([]),j=Object(r.a)(l,2),d=j[0],b=j[1],f=Object(c.useRef)(),O=Object(c.useRef)(),m=function(e){return Array.from(e.values()).map((function(e){return e.track})).filter((function(e){return null!==e}))};return Object(c.useEffect)((function(){u(m(t.videoTracks)),b(m(t.audioTracks));return t.on("trackSubscribed",(function(e){"video"===e.kind?u((function(t){return[].concat(Object(P.a)(t),[e])})):"audio"===e.kind&&b((function(t){return[].concat(Object(P.a)(t),[e])}))})),t.on("trackUnsubscribed",(function(e){"video"===e.kind?u((function(t){return t.filter((function(t){return t!==e}))})):"audio"===e.kind&&b((function(t){return t.filter((function(t){return t!==e}))}))})),function(){u([]),b([]),t.removeAllListeners()}}),[t]),Object(c.useEffect)((function(){var e=o[0];if(e)return e.attach(f.current),function(){e.detach()}}),[o]),Object(c.useEffect)((function(){var e=d[0];if(e)return e.attach(O.current),function(){e.detach()}}),[d]),Object(h.jsxs)("div",{className:"participant ".concat(0===(null===n||void 0===n?void 0:n.length)&&"one_participant"),children:[Object(h.jsx)("p",{className:"participant-name",children:t.identity===a?"You":t.identity}),Object(h.jsx)("video",{ref:f,autoPlay:!0}),Object(h.jsx)("audio",{ref:O,autoPlay:!0})]})}),L=n(201),M=n(119),B=n(202),F=n.n(B),T="new-message-event",U=function(e){var t=Object(c.useState)([]),n=Object(r.a)(t,2),a=n[0],i=n[1],s=Object(c.useRef)();Object(c.useEffect)((function(){return s.current=F()("https://trishul-meeting-server.herokuapp.com/",{query:{roomId:e}}),s.current.on(T,(function(e){var t=Object(M.a)(Object(M.a)({},e),{},{isOwner:e.senderId===s.current.id});i((function(e){return[].concat(Object(P.a)(e),[t])}))})),function(){s.current.disconnect()}}),[e]);return{messages:a,sendMessage:function(e,t){t?s.current.emit(T,{body:t,type:"file",mimeType:t.type,fileName:t.name,senderId:s.current.id}):s.current.emit(T,{body:e,senderId:s.current.id})}}},G=(n(397),n(206)),J=n.n(G),W=n(460),K=n(470),V=n(205),z=n.n(V);var q=function(e){var t=Object(c.useState)(""),n=Object(r.a)(t,2),a=n[0],i=n[1];return Object(c.useEffect)((function(){var t=new FileReader;t.readAsDataURL(e.blob),t.onloadend=function(){i(t.result)}}),[e.blob]),Object(h.jsx)("img",{className:"image",style:{width:150,height:"auto"},src:a,alt:e.fileName})},H=n(203),Y=n.n(H),Q=n(204),Z=n.n(Q),X=function(e){var t=e.roomId,n=U(t),a=n.messages,i=n.sendMessage,s=Object(c.useState)(""),o=Object(r.a)(s,2),u=o[0],l=o[1],j=Object(c.useState)(),d=Object(r.a)(j,2),b=d[0],f=d[1],O=Object(c.useState)(null),m=Object(r.a)(O,2),p=(m[0],m[1]),g=Object(c.useState)("notDisplayEmoji"),v=Object(r.a)(g,2),x=v[0],y=v[1],N=Object(c.useRef)(),S=function(){""!==u&&(i(u,b),l(""),f(),y("notDisplayEmoji"))};return Object(c.useEffect)((function(){return N.current.scrollIntoView({behavior:"smooth"})})),Object(h.jsx)("div",{className:"chatbox",children:Object(h.jsxs)("div",{className:"chatRoomMain",children:[Object(h.jsxs)("div",{className:"group_chat_bar",children:[Object(h.jsx)("span",{className:"group_chat_title",children:"Group Chat"}),Object(h.jsx)("span",{className:"group_chat_msg_btn",children:"Messages"}),Object(h.jsx)("span",{className:"group_chat_partici",children:"Participants"})]}),Object(h.jsxs)("div",{className:"chat-container",children:[Object(h.jsxs)("div",{className:"msg",children:[Object(h.jsx)("ol",{id:"messages",children:a.map((function(e,t){if("file"===e.type){var n=new Blob([e.body],{type:e.type});return Object(h.jsx)("div",{className:e.isOwner?"my-message":"received-message",children:Object(h.jsx)("div",{className:"msgBody",children:Object(h.jsx)(q,{fileName:e.fileName,blob:n})})},t)}return Object(h.jsx)("div",{className:e.isOwner?"my-message":"received-message",children:Object(h.jsx)("div",{className:"msgBody",children:Object(h.jsx)(Z.a,{componentDecorator:function(e,t){return Object(h.jsx)(L.SecureLink,{href:e,children:t})},children:e.body})})},t)}))}),Object(h.jsx)("div",{ref:N})]}),Object(h.jsx)("div",{className:x,children:Object(h.jsx)(Y.a,{onEmojiClick:function(e,t){l(u+t.emoji),p(t)}})})]}),Object(h.jsxs)("div",{id:"form",className:"textField",children:[Object(h.jsxs)("label",{htmlFor:"raised-button-file",children:[Object(h.jsx)("input",{accept:"image/*",onChange:function(e){l(e.target.files[0].name),f(e.target.files[0])},style:{display:"none"},id:"raised-button-file",multiple:!0,type:"file"}),Object(h.jsx)(K.a,{className:"camera","aria-label":"upload picture",component:"span",children:Object(h.jsx)(W.a,{})})]}),Object(h.jsx)("label",{children:Object(h.jsx)(K.a,{"aria-label":"emoji",component:"span",onClick:function(){"notDisplayEmoji"===x?y("displayEmoji"):"displayEmoji"===x&&y("notDisplayEmoji")},children:Object(h.jsx)(z.a,{})})}),Object(h.jsx)("input",{id:"message",placeholder:"Enter message here",value:u,onChange:function(e){l(e.target.value)},onKeyUp:function(e){"Enter"===e.key&&S()}}),Object(h.jsx)("button",{onClick:S,children:Object(h.jsx)(J.a,{})})]})]})})},$=(n(410),function(e){var t=e.roomName,n=e.room,a=(e.handleLogout,e.currentUser),i=Object(c.useState)([]),s=Object(r.a)(i,2),o=s[0],u=s[1],l=Object(c.useState)("displayChat"),j=Object(r.a)(l,2),d=j[0];j[1];console.log(o),Object(c.useEffect)((function(){var e=function(e){u((function(t){return[].concat(Object(P.a)(t),[e])}))},t=function(e){u((function(t){return t.filter((function(t){return t!==e}))}))};return n.on("participantConnected",e),n.on("participantDisconnected",t),n.participants.forEach(e),function(){n.off("participantConnected",e),n.off("participantDisconnected",t)}}),[n]);var b=o.map((function(e){return Object(h.jsx)(R,{participant:e,currentUser:a},e.sid)}));return Object(h.jsxs)("main",{className:"room",children:[Object(h.jsxs)("div",{className:"all-participants",children:[n?Object(h.jsx)(R,{totalParticipant:o,participant:n.localParticipant},n.localParticipant.sid):"",b]}),Object(h.jsx)("div",{className:"chatRoom",children:Object(h.jsx)("div",{className:d,children:Object(h.jsx)(X,{roomId:t})})})]})}),ee=Object(w.a)(),te=Object(E.a)((function(){return{large:{width:ee.spacing(7),height:ee.spacing(7)}}}));var ne=function(){var e=Object(c.useState)(null),t=Object(r.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)("empty"),s=Object(r.a)(i,2),o=(s[0],s[1]),u=Object(c.useState)(null),l=Object(r.a)(u,2),j=l[0],d=(l[1],Object(c.useState)(new Date)),b=Object(r.a)(d,2),f=(b[0],b[1]),O=Object(c.useState)(""),m=Object(r.a)(O,2),p=m[0],g=m[1],E=Object(c.useState)(null),w=Object(r.a)(E,2),A=w[0],P=w[1],R=Object(c.useState)(""),L=Object(r.a)(R,2),M=L[0],B=L[1];te(),Object(C.f)(),Boolean(j),null!==(null===n||void 0===n?void 0:n.displayName)&&(null===n||void 0===n||n.displayName.charAt(0).toUpperCase()),Object(c.useEffect)((function(){return I.onAuthStateChanged((function(e){e?(a(e),o("home")):(a(null),o("login"))})),setInterval((function(){return f(new Date)}),1e3)}),[]),Object(c.useEffect)((function(){n&&B(n.email)}),[n]);var F=Object(c.useCallback)(Object(x.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://twilio-meeting-server.herokuapp.com/video/token",{method:"POST",body:JSON.stringify({identity:M,room:p}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}));case 2:t=e.sent,D.a.connect(t.token,{name:p}).then((function(e){P(e)})).catch((function(e){console.error(e)})),console.log(t);case 5:case"end":return e.stop()}}),e)}))),[p,M]),T=Object(c.useCallback)((function(){P((function(e){return e&&(e.localParticipant.tracks.forEach((function(e){e.track.stop()})),e.disconnect()),null}))}),[]);return Object(c.useEffect)((function(){if(A){var e=function(e){e.persisted||A&&T()};return window.addEventListener("pagehide",e),window.addEventListener("beforeunload",e),function(){window.removeEventListener("pagehide",e),window.removeEventListener("beforeunload",e)}}}),[A,T]),A?Object(h.jsx)($,{roomName:p,room:A,handleLogout:T,currentUser:n}):Object(h.jsx)("div",{children:Object(h.jsx)("div",{className:"home",children:Object(h.jsx)("div",{className:"home__left",children:Object(h.jsxs)("div",{className:"home__buttons",children:[Object(h.jsxs)(y.a,{color:"primary",variant:"contained",className:"home__createBTN",onClick:function(){var e=Date.now();console.log(e),e=(e=Math.floor(Math.random()*Math.floor(Math.random()*e.toString().slice(-9)))).toString().substring(0,3)+"-"+e.toString().substring(3,6)+"-"+e.toString().substring(6,e.toString().length),console.log(e),g(e)},children:[Object(h.jsx)(k.a,{}),Object(h.jsx)("p",{children:"New meeting"})]}),Object(h.jsx)(N.a,{className:"home__input",variant:"outlined",value:p,onChange:function(e){return g(e.target.value)},placeholder:"Enter a code or link",InputProps:{startAdornment:Object(h.jsx)(S.a,{position:"start",children:Object(h.jsx)(_.a,{className:"icon"})})}}),Object(h.jsx)(y.a,{color:"primary",variant:"outlined",className:"home__joinBTN",disabled:""===p,onClick:function(){""!==p&&F()},children:"Join"}),Object(h.jsx)(y.a,{onClick:function(){return I.signOut()},variant:"outlined",className:"home__signOut",children:"Sign Out"})]})})})})};n(121),n(415),n(216),n(208),n(209),n(210),n(214),n(212),n(211),n(215),n(213),Object(E.a)({root:{background:"linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)"}});var ce=n(113);var ae=function(){var e=Object(c.useState)(null),t=Object(r.a)(e,2),n=(t[0],t[1]),a=Object(c.useState)("empty"),i=Object(r.a)(a,2),s=i[0],o=i[1];return Object(c.useEffect)((function(){I.onAuthStateChanged((function(e){e?(n(e),o("home")):(n(null),o("login"))}))}),[]),Object(h.jsx)("div",{className:"App",children:Object(h.jsx)(ce.a,{children:Object(h.jsx)(C.c,{children:Object(h.jsx)(C.a,{path:"/Joins-Meeting-App",exact:!0,children:Object(h.jsxs)("div",{children:["empty"===s&&Object(h.jsx)("p",{children:"Loading...."}),"home"===s&&Object(h.jsx)(ne,{}),"login"===s&&Object(h.jsx)(p,{})]})})})})})};s.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(ae,{})}),document.getElementById("root"))}},[[416,1,2]]]);
//# sourceMappingURL=main.8a34eb3b.chunk.js.map